<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Random Quote Generator</title>
<!-- Tailwind CSS for styling -->
<script src="https://cdn.tailwindcss.com"></script>
<!-- Inter font -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
<style>
body {
font-family: 'Inter', sans-serif;
}
/* Style for when the button is disabled */
#new-quote-btn:disabled {
background-color: #5f9ea0; /* A muted cyan */
cursor: not-allowed;
transform: scale(1);
}
</style>
</head>
<body class="bg-gray-900 text-white flex items-center justify-center h-screen">

<!-- Main container for the quote generator -->
<div class="w-full max-w-2xl mx-auto p-6 md:p-8 bg-gray-800 rounded-2xl shadow-2xl text-center">

<!-- Header -->
<h1 class="text-3xl md:text-4xl font-bold text-cyan-400 mb-6">Random Quote Generator</h1>

<!-- Quote Display Area -->
<div class="min-h-[150px] flex flex-col justify-center">
<blockquote id="quote-text" class="text-xl md:text-2xl italic text-gray-200 transition-opacity duration-500">
<!-- Quote will be inserted here by JavaScript -->
Loading...
</blockquote>
<p id="quote-author" class="mt-4 text-lg text-cyan-500 font-semibold transition-opacity duration-500">
<!-- Author will be inserted here by JavaScript -->
</p>
</div>

<!-- Button to generate a new quote -->
<button id="new-quote-btn" class="mt-8 bg-cyan-500 hover:bg-cyan-600 text-white font-bold py-3 px-6 rounded-lg shadow-lg transition-transform transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-cyan-400 focus:ring-opacity-75 disabled:bg-cyan-800 disabled:cursor-not-allowed disabled:transform-none">
New Quote
</button>

</div>

<script>
// --- JavaScript for the Quote Generator (API Version with History) ---

// 1. Get references to the HTML elements
const quoteTextElement = document.getElementById('quote-text');
const quoteAuthorElement = document.getElementById('quote-author');
const newQuoteBtn = document.getElementById('new-quote-btn');

// 2. Define the API endpoint and history tracking variables
const quoteAPI = 'https://dummyjson.com/quotes/random';
let recentQuoteIds = []; // Array to store the IDs of recent quotes
const HISTORY_LIMIT = 25; // How many recent quotes to remember

// 3. Function to fetch a new unique quote from the API and display it.
async function getNewQuote() {
// Disable button and fade out the current quote text
newQuoteBtn.disabled = true;
quoteTextElement.style.opacity = 0;
quoteAuthorElement.style.opacity = 0;

try {
let uniqueQuoteFound = false;
let quoteData;
let attempts = 0; // Safety counter to prevent an infinite loop

// Loop until we find a quote that isn't in our recent history
do {
const response = await fetch(quoteAPI);
if (!response.ok) {
throw new Error(`HTTP error! status: ${response.status}`);
}
quoteData = await response.json();

// Check if the fetched quote's ID is in our history array
if (!recentQuoteIds.includes(quoteData.id)) {
uniqueQuoteFound = true;
}
attempts++;
} while (!uniqueQuoteFound && attempts < 50); // Try up to 50 times

if (!uniqueQuoteFound) {
console.warn("Could not find a unique quote after 50 attempts. Displaying the last one fetched.");
}

// Add the new quote's ID to our history
recentQuoteIds.push(quoteData.id);

// If the history is over the limit, remove the oldest quote ID (from the start of the array)
if (recentQuoteIds.length > HISTORY_LIMIT) {
recentQuoteIds.shift();
}

// Update the text content of the elements with data from the API
quoteTextElement.textContent = `"${quoteData.quote}"`;
quoteAuthorElement.textContent = `- ${quoteData.author}`;

} catch (error) {
// If anything goes wrong in the 'try' block, this code runs.
console.error("Error fetching quote:", error);
quoteTextElement.textContent = "Oops! Couldn't fetch a quote. Please try again.";
quoteAuthorElement.textContent = "";
} finally {
// This block always runs, ensuring the UI updates correctly.
// We use a short delay to allow the fade-out transition to be visible.
setTimeout(() => {
quoteTextElement.style.opacity = 1;
quoteAuthorElement.style.opacity = 1;
newQuoteBtn.disabled = false; // Re-enable the button
}, 200);
}
}

// 4. Add an event listener to the button.
newQuoteBtn.addEventListener('click', getNewQuote);

// 5. Display a quote when the page first loads.
document.addEventListener('DOMContentLoaded', getNewQuote);

</script>

</body>
</html>
